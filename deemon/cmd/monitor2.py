import logging

from deemon.cmd import search
from deemon.core.logger import setup_logger
from deemon.utils import performance, startup
from tqdm import tqdm
from deemon.core.db import Database
from concurrent.futures import ThreadPoolExecutor
from deemon.core.config import Config
from deemon.core.api import PlatformAPI

setup_logger(log_level='DEBUG', log_file=startup.get_log_file())
logger = logging.getLogger("deemon")

config = Config()

class Monitor:

    def __init__(self, is_search: bool = False):
        self.bitrate = None
        self.alerts = None
        self.record_type = None
        self.download_path = None
        self.remove = False
        self.refresh = True
        self.is_search = is_search
        self.dl = None
        self.db = Database()
        self.api = PlatformAPI("deezer-gw")

        self.artist_not_found = []

    def set_bitrate(self, bitrate: str):
        self.bitrate = bitrate

    def set_alerts(self, alerts: bool):
        self.alerts = alerts

    def set_record_type(self, record_type: str):
        self.record_type = record_type

    def set_download_path(self, download_path: str):
        self.download_path = download_path

    def get_best_result(self, name) -> list:
        api_result = self.api.search_artist(name, limit=5)
        matches = [r for r in api_result if r['name'].lower() == name.lower()]
        if not len(matches):
            self.artist_not_found.append(name)
            return []
        return matches

    def prompt_duplicate(self, value):
        if self.is_search or config.prompt_duplicates():
            menu = search.Search()
            ask_user = menu.search_menu(value)
            if ask_user:
                return {'id': ask_user[0]['id'], 'name': ask_user[0]['name']}
            return logger.debug("No artist selected, skipping...")
        else:
            if not config.prompt_duplicates():
                return logger.error(f"Duplicate artist names found for {value}. Try again using --search")

    @performance.timeit
    def build_query(self, api_result: list):
        existing = self.db.get_all_monitored_artist_ids()
        artists_to_add = []
        artists_exist = []
        pbar = tqdm(api_result, total=len(api_result), desc="Monitoring artists ...", ascii=" #", bar_format='[{n_fmt}/{total_fmt}] {desc} [{bar}] {percentage:3.0f}%')
        for i, artist in enumerate(pbar):
            if artist['id'] in existing:
                artists_exist.append(artist)
            else:
                artist.update({'bitrate': self.bitrate, 'alerts': self.alerts, 'record_type': self.record_type,
                               'download_path': self.download_path, 'profile_id': config.profile_id(),
                               'trans_id': config.transaction_id()})
                artists_to_add.append(artist)

        self.db.fast_monitor(artists_to_add)
        self.db.commit()
        self.show_report(artists_to_add, artists_exist)

    def show_report(self, added: list, existing: list):
        num_added = len(added)
        num_exist = len(existing)
        logger.info(f"Added {num_added} new artist(s), already monitoring {num_exist} artist(s)")

    @performance.timeit
    def artists(self, names: list) -> None:
        """
        Return list of dictionaries containing each artist
        """
        with ThreadPoolExecutor(max_workers=self.api.max_threads) as ex:
            api_result = list(tqdm(ex.map(self.get_best_result, names), total=len(names), desc="Getting artist info...", ascii=" #", bar_format='[{n_fmt}/{total_fmt}] {desc} [{bar}] {percentage:3.0f}%'))
        for i, artist in enumerate(api_result):
            if len(artist) > 1 and config.prompt_duplicates():
                prompt = self.prompt_duplicate(artist[0]['name'])
                if prompt:
                    api_result[i] = [prompt]
                else:
                    api_result[i] = []
            elif len(artist) > 1:
                api_result[i] = [artist[0]]
        api_result = [item for elem in api_result for item in elem if len(item)]
        self.build_query(api_result)

    def artist_ids(self, ids: list):
        pass

    def urls(self, urls: list):
        pass

    def playlists(self, playlists: list):
        pass

    @performance.timeit
    def purge_artists(self, names: list = None, ids: list = None):
        if names:
            # names = [(x,) for x in names]
            result = self.db.select_artists(names)
            print(result)
            exit()
            self.db.remove_artists(names)
        if ids:
            ids = [(x,) for x in ids]
            self.db.remove_artists(ids)


    def purge_playlists(self, titles: list):
        pass


if __name__ == "__main__":
    list_of_artist_names = ['Andrew Belle', 'Augustana', 'Austin Plaine', 'Billie Eilish', 'Brynn Elliott', 'Caamp', 'Charlotte Lawrence', 'Damien Rice', 'Dan Layus', 'DAUGHTER', 'David Ramirez', 'Dermot Kennedy', 'Donovan Woods', 'Ed Sheeran', 'Emily Burns', 'Gracie Abrams', 'Gregory Alan Isakov', 'Hayley Orrantia', 'Holly Humberstone', 'Jamestown Revival', 'Jason Aldean', 'Jason Wade', 'John Moreland', 'Kacey Musgraves', 'KALEO', 'Lifehouse', 'Luke Bryan', 'Luke Combs', 'Maggie Rogers', 'Manchester Orchestra', 'matchbox twenty', 'Matthew Mayfield', 'Molly Parden', 'Noah Gundersen', 'Orla Gartland', 'Paramore', 'Poor Nameless Boy', 'Sasha Alex Sloan', 'Sean McConnell', 'Tate McRae', 'Taylor Swift', 'The Blue Cut Robbery', 'The Fray', 'The Maine', 'The Spill Canvas', 'Thrice', 'Thriving Ivory', 'We Three', 'William Clark Green', 'William Fitzsimmons']
    # list_of_artist_names = ['2 Chainz', '21 Savage', '24 Horas', '42 Dugg', '6IX9INE', 'A Boogie Wit da Hoodie', 'A$AP Ferg', 'A$AP Rocky', 'Aaron May', 'Abdiel', 'Adolescentes Orquesta', 'Akim', "Ala'a Al Zalzali", 'Alejandro Sanz', 'Alex Bueno', 'Alex Rose', 'Alexis & Fido', 'Alexis y Fido', 'Amaro', 'Amenazzy', 'Andy Montañez', 'Andy Rivera', 'Angel y Khriz', 'Anitta', 'Anonimus', 'Anthony Santos', 'Anuel Aa', 'Anyelo RR', 'Arcangel', 'Artista Rosario', 'Aventura', 'Baby Ranks', 'Baby Rasta', 'Baby Rasta & Gringo', 'Bachata Heightz', 'Bachata Hit', 'Bachata Latin Band', 'Bad Bunny', 'Becky G', 'Beele', 'Beiza', 'Beyoncé', 'Big L', 'Big Pun', 'Big Sean', 'BigBoyDrum', 'Blueface', 'Bobby Shmurda', 'Borja Rubio', 'Bozá', 'Brray', 'Bruno Mars', 'Bryant Myers', 'Bryson Tiller', 'Brytiago', 'Buxxi', 'C4 Champion', 'Cali Y El Dandee', 'Calka', 'Camilo', 'Cardi B', 'Carlitos Rossy', 'Carlos Unger', 'Carlos Vives', 'Carlos Y Alejandra', 'Casa De Leones', 'Casper Magico', 'Cauty', 'Cazzu', 'Ceaese', 'Celia Cruz', 'Cheka', 'Chencho Corleone', 'Chief Keef', 'Chino & Nacho', 'Choclock', 'Chris Andrew', 'Chris Brown', 'Chris Jedi', 'Chriz LaKruz', 'CNCO', 'Cosculluela', 'Crissin', "D'Lyon", 'D-Enyel', 'DaBaby', 'Daddy Yankee', 'Dalex', 'Dama', 'Dani J', 'Danna Paola', 'Danny Ocean', 'Darell', 'Darkiel', 'Dave Matthews Band', 'David Pabón', 'Dayme y El High', 'De La Ghetto', 'Desiigner', 'Divino', 'Dj Drama', 'DJ Khaled', 'Dj Khalid', 'Dj Luian', 'DJ Memo', 'DJ Nelson', 'DJ Tronky', 'Doja Cat', 'Don chezina', 'Don Omar', 'Drake', 'Dímelo Flow', 'Ecko', 'Eddie Dee', 'Eddie Santiago', 'Eddy Lover', 'Eix', 'El Alfa', 'El Chaval', 'El Chaval De La Bachata', 'El General', 'El Gran Combo', 'El Gran Combo de Puerto Rico', 'Eladio Carrion', 'Eloy', 'Elvis Crespo', 'ELYSANIJ', 'Emilia', 'Eminem', 'Enrique Iglesias', 'Eric Bellinger', 'Erre Xi', 'Esme', 'Eunel Nueva Era', 'F4 y Eminencia', 'Farina', 'Farruko', 'Fat Trel', 'Feid', 'Ferrer El Tanque', 'Fetty Wap', 'Flex', 'Flow La Movie', 'FNF Chop', 'Franco "El Gorilla"', 'Franco El Gorila', 'Frank Reyes', 'Frankie Ruiz', 'French Montana', 'Fresh Kid Cue', 'Future', 'Gaby Morales', 'Galante "El Emperador"', 'Genio', 'Gente De Zona', 'Gilberto Santa Rosa', 'Gino Mella', 'Gotay "El Autentiko"', 'Greeicy', 'Grupo Extra', 'Grupo Niche', 'Guayacan Orquesta', 'Guaynaa', 'Gucci Mane', 'guccihighwaters', 'Guelo Star', 'Haga Su Diligencia', 'Hancel', 'Hansen Akilez', 'Hector Acosta "El Torito"', 'Hotboii', 'Hozwal', 'Héctor "El Father"', 'Héctor Lavoe', 'Ismael Rivera', 'Ivy Queen', 'Izaak', 'J Alvarez', 'J Balvin', 'J Gonz', 'J-King y Maximan', 'J. Cole', 'Jack Harlow', 'Jadi Torres', 'Jadiel', 'Jadiel el Incomparable', 'Jahzel', 'Jamby El Favo', 'Javiielo', 'Jay Ramirez', 'Jay Wheeler', 'Jay-Z', 'Jazz Cartier', 'Jd Pantoja', 'Jeezy', 'Jehu El Rey', 'Jerry Rivera', 'JFab & Paola Fabre', 'Jhay Cortez', 'Jim Jones', 'Jodosky', 'Joe Arroyo', 'Joe Veras', 'Johnny Rivera', 'Jon Z', 'Jonna Torres', 'Jorge Ruiz', 'Jory Boy', 'Jose Peña Suazo Y La Banda Gorda', 'José José', 'Jounel', 'Jowell & Randy', 'Juan Gabriel', 'Juan Luis Guerra', 'Juan Luis Guerra 440', 'Juanes', 'Juanka', 'Juhn', 'Juice Wrld', 'Juicy J', 'Juno "The Hitmaker"', 'Justin Quiles', 'JVO the Writer', 'K-Drian', 'Kanye West', 'Karlos Rosé', 'KAROL G', 'Kelmitt', 'Kendo Kaponi', 'Kendrick Lamar', 'Kevin Gates', 'Kevin Roldan', 'KEVVO', 'Kewin Cosmos', 'Keytel', 'KHEA', 'Kid Cudi', 'Kid Ink', 'Kiko El Crazy', 'Killatonez', 'King Von', 'Kodak Black', 'La Banda Gorda', 'La Gloria Matancera', 'Lafame', 'Lalo Ebratt', 'Lary Over', 'LeBray', 'Lele Pons', 'Lenny Tavarez', 'Lil Baby', 'Lil Durk', 'Lil Eazzyy', 'Lil Gnar', 'Lil Tecca', 'Lil Tjay', 'Lil Uzi Vert', 'Lil Wayne', 'Lil Yachty', 'Limi-t XXI', 'Linares', 'Linkin Park', 'Linowz', 'Lirow', 'Llane', 'Logic', 'Los Cantantes', 'Los De La Nazza', 'Los Hermanos Rosario', 'Los Legendarios', 'Los Toros Band', 'Luigi 21 Plus', 'Luis Fonsi', 'Luis Miguel', 'Luis Vazquez', 'Lula Miranda', 'Lunay', 'Luny Tunes', 'Lyanno', 'MAC MILLER', 'Mackie', 'MadeinTYO', 'MadMarcc', 'Maelo Ruiz', 'Magnate Y Valentino', 'Maluma', 'Mambo Kingz', 'Manny Rod', 'Manuel Turizo', 'Maná', 'Marc Anthony', 'Marco Puma', 'Mariah Angeliq', 'Mau y Ricky', 'Mc ceja', 'Meek Mill', 'Mega Sexxx', 'Mega XxX', 'Merengue Latin Band', 'Messiah', 'Metro Boomin', 'Migos', 'Mike Bahia', 'Mike Will Made-It', 'Miky Woodz', 'Monchy & Alexandra', 'Moneybagg Yo', 'Montano', 'Mozart la Para', 'Mr. Don', 'Mr. Frank & Gabyson', 'Musicologo Y Menes', 'Myke Towers', "N'Klabe", 'Nas', 'Natti Natasha', 'NAV', 'Neutro Shorty', 'Nfasis', 'Nicky Jam', 'Nicole Zignago', 'Nigga', 'Nio Garcia', 'NLE Choppa', 'Noriega', 'Noriel', 'Nova y Jory', 'O.T. Genasis', 'Offset', 'Olga Tañón', 'Oro Solido', "Oscar D'León", 'Ovi', 'Ozuna', 'Pacho El Antifeka', 'Paquito Guzmán', 'Paradize', 'PARTYNEXTDOOR', 'Paulina Rubio', 'Pinto Picasso', 'Piso 21', 'Playboi Carti', 'Plies', 'PnB Rock', 'POLO G', 'Pooh Shiesty', 'Pop Smoke', 'Post Malone', 'Prince Royce', 'Project Pat', 'Pusho', 'Quality Control', 'Quando Rondo', 'Quavo', 'Rae Sremmurd', 'Rafa Pabön', 'Ralphy Dreamz', 'Ramon Orlando', 'Randy', 'Raphy Leavitt & Orquesta La Selecta', 'Raulín Rodríguez', 'Rauw Alejandro', 'Rayda la Sensacion', 'Reik', 'Rey Ruiz', 'Reykon', 'Rich Homie Quan', 'RICH MUSIC LTD', 'Rich The Kid', 'Rick Ross', 'Rikar2nes', 'Rikarena', 'Rod Wave', 'Roddy Ricch', 'Rodrigo Films', 'Romeo Santos', 'Ronald El Killa', 'Rosalía', 'Roy Woods', 'Rubén Blades', 'Ruuz', 'Rvssian', 'Ryan Castro', 'Sael', 'Sammy & Falsetto', 'Schoolboy Q', 'Sebastian LVDA', 'Sebastian Yatra', 'Sech', 'Sergio Vargas', 'Shy Glizzy', 'Silvestre Dangond', 'Sixto Rein', 'Ski Mask the Slump God', 'Sky', 'Slim Thug', 'SOG', 'SP Polanco', 'Speaker Knockerz', 'Stampede Artist', 'Super Yei', 'Swae Lee', 'Tainy', 'Takeoff', 'Tee Grizzley', 'Tego Calderón', 'Tempo', 'Tenso Beats', 'Teodoro Reyes', 'The Diplomats', 'The Notorious B.I.G.', 'The Weeknd', 'Tiago pzk', 'Tito El Bambino', 'Tito Nieves', 'Tito Rojas', 'Toby Love', 'Tommy Olivencia', 'Tony Dize', 'Tony Lenta', 'Tony Vega', 'Tory Lanez', 'Totoy El Frio', 'Toño Rosario', 'Travis Porter', 'Travis Scott', 'Trebol Clan', 'Trevor Daniel', 'Trippie Redd', 'Ty Dolla $ign', 'Tyla Yaweh', 'Tyler, The Creator', 'vf7', 'Vicente Fernández', 'Victor Manuelle', 'Voltio', 'Voz A Voz', 'Waka Flocka Flame', 'Wale', 'Wibal y Alex', 'Wilfrido Vargas', 'Willie Colón', 'Willie Gonzalez', 'Wise "the Gold Pen"', 'Wisin', 'Wisin & Yandel', 'Wiz Khalifa', 'WWE', 'Xtreme', 'XXXTentacion', 'Yaga & Mackie', 'Yandel', 'Yelsid', 'Yextiel', 'YNW Melly', 'Yo Gotti', 'Yomo', 'Young Chop', 'Young Cister', 'Young Dolph', 'Young Eiby', 'Young Stoner Life', 'Young Thug', 'YoungBoy Never Broke Again', 'Yung Gravy', 'Zacarías Ferreira', 'ZAYTOVEN', 'Zion', 'Zion & Lennox', 'Ñejo', 'Ñengo Flow', 'Öken']

    mock_api = [{'id': 1384338, 'name': '2 Chainz'}, {'id': 6853403, 'name': '21 Savage'}, {'id': 1523880, 'name': '24 Horas'}, {'id': 13130577, 'name': '42 Dugg'}, {'id': 13124535, 'name': '6IX9INE'}, {'id': 9539088, 'name': 'A Boogie Wit da Hoodie'}, {'id': 4341930, 'name': 'A$AP Ferg'}, {'id': 1518490, 'name': 'A$AP Rocky'}, {'id': 52610412, 'name': 'Aaron May'}, {'id': 4951651, 'name': 'Abdiel'}, {'id': 4027861, 'name': 'Adolescentes Orquesta'}, {'id': 1272748, 'name': 'Akim'}, {'id': 121683, 'name': "Ala'a Al Zalzali"}, {'id': 4479, 'name': 'Alejandro Sanz'}, {'id': 260094, 'name': 'Alex Bueno'}, {'id': 4485154, 'name': 'Alex Rose'}, {'id': 183695, 'name': 'Alexis & Fido'}, {'id': 16708, 'name': 'Alexis y Fido'}, {'id': 1065373, 'name': 'Amaro'}, {'id': 11342468, 'name': 'Amenazzy'}, {'id': 95238, 'name': 'Andy Montañez'}, {'id': 4814134, 'name': 'Andy Rivera'}, {'id': 3151, 'name': 'Angel y Khriz'}, {'id': 4390053, 'name': 'Anitta'}, {'id': 173026, 'name': 'Anonimus'}, {'id': 1311276, 'name': 'Anthony Santos'}, {'id': 7961888, 'name': 'Anuel Aa'}, {'id': 12309544, 'name': 'Anyelo RR'}, {'id': 5536564, 'name': 'Arcangel'}, {'id': 3797031, 'name': 'Artista Rosario'}, {'id': 700, 'name': 'Aventura'}, {'id': 3149, 'name': 'Baby Ranks'}, {'id': 14061, 'name': 'Baby Rasta'}, {'id': 186631, 'name': 'Baby Rasta & Gringo'}, {'id': 358296, 'name': 'Bachata Heightz'}, {'id': 4186452, 'name': 'Bachata Hit'}, {'id': 156579, 'name': 'Bachata Latin Band'}, {'id': 10583405, 'name': 'Bad Bunny'}, {'id': 4698748, 'name': 'Becky G'}, {'id': 68358002, 'name': 'Beele'}, {'id': 145, 'name': 'Beyoncé'}, {'id': 8839, 'name': 'Big L'}, {'id': 626072, 'name': 'Big Pun'}, {'id': 15427, 'name': 'Big Sean'}, {'id': 68304162, 'name': 'BigBoyDrum'}, {'id': 3700221, 'name': 'Blueface'}, {'id': 6208668, 'name': 'Bobby Shmurda'}, {'id': 1408429, 'name': 'Borja Rubio'}, {'id': 10186978, 'name': 'Brray'}, {'id': 429675, 'name': 'Bruno Mars'}, {'id': 9945206, 'name': 'Bryant Myers'}, {'id': 7004075, 'name': 'Bryson Tiller'}, {'id': 7511588, 'name': 'Brytiago'}, {'id': 1651825, 'name': 'Buxxi'}, {'id': 12873781, 'name': 'C4 Champion'}, {'id': 2855621, 'name': 'Cali Y El Dandee'}, {'id': 12991105, 'name': 'Calka'}, {'id': 58568762, 'name': 'Camilo'}, {'id': 9064930, 'name': 'Cardi B'}, {'id': 1649516, 'name': 'Carlitos Rossy'}, {'id': 5595926, 'name': 'Carlos Unger'}, {'id': 7343, 'name': 'Carlos Vives'}, {'id': 318079, 'name': 'Carlos Y Alejandra'}, {'id': 265298, 'name': 'Casa De Leones'}, {'id': 11569041, 'name': 'Casper Magico'}, {'id': 4711584, 'name': 'Cauty'}, {'id': 12268072, 'name': 'Cazzu'}, {'id': 5408130, 'name': 'Ceaese'}, {'id': 5024, 'name': 'Celia Cruz'}, {'id': 986224, 'name': 'Cheka'}, {'id': 49544582, 'name': 'Chencho Corleone'}, {'id': 2934901, 'name': 'Chief Keef'}, {'id': 358580, 'name': 'Chino & Nacho'}, {'id': 9754050, 'name': 'Choclock'}, {'id': 4788658, 'name': 'Chris Andrew'}, {'id': 102, 'name': 'Chris Brown'}, {'id': 101706332, 'name': 'Chris Jedi'}, {'id': 13471897, 'name': 'Chriz LaKruz'}, {'id': 9759672, 'name': 'CNCO'}, {'id': 746471, 'name': 'Cosculluela'}, {'id': 3674271, 'name': 'Crissin'}, {'id': 7525122, 'name': "D'Lyon"}, {'id': 9082316, 'name': 'D-Enyel'}, {'id': 11363014, 'name': 'DaBaby'}, {'id': 3839, 'name': 'Daddy Yankee'}, {'id': 4056850, 'name': 'Dalex'}, {'id': 92711, 'name': 'Dama'}, {'id': 7890674, 'name': 'Dani J'}, {'id': 318108, 'name': 'Danna Paola'}, {'id': 11443084, 'name': 'Danny Ocean'}, {'id': 5844239, 'name': 'Darell'}, {'id': 8834928, 'name': 'Darkiel'}, {'id': 245, 'name': 'Dave Matthews Band'}, {'id': 123949, 'name': 'David Pabón'}, {'id': 8590800, 'name': 'Dayme y El High'}, {'id': 1020198, 'name': 'De La Ghetto'}, {'id': 9551192, 'name': 'Desiigner'}, {'id': 145155, 'name': 'Divino'}, {'id': 330512, 'name': 'Dj Drama'}, {'id': 5828, 'name': 'DJ Khaled'}, {'id': 268283, 'name': 'Dj Khalid'}, {'id': 5639048, 'name': 'Dj Luian'}, {'id': 1320217, 'name': 'DJ Memo'}, {'id': 185943, 'name': 'DJ Nelson'}, {'id': 14668563, 'name': 'DJ Tronky'}, {'id': 5578942, 'name': 'Doja Cat'}, {'id': 279665, 'name': 'Don chezina'}, {'id': 725, 'name': 'Don Omar'}, {'id': 246791, 'name': 'Drake'}, {'id': 12588946, 'name': 'Dímelo Flow'}, {'id': 4130953, 'name': 'Ecko'}, {'id': 269513, 'name': 'Eddie Dee'}, {'id': 8734, 'name': 'Eddie Santiago'}, {'id': 894112, 'name': 'Eddy Lover'}, {'id': 6099582, 'name': 'Eix'}, {'id': 1611773, 'name': 'El Alfa'}, {'id': 399099, 'name': 'El Chaval'}, {'id': 440530, 'name': 'El Chaval De La Bachata'}, {'id': 185881, 'name': 'El General'}, {'id': 1256555, 'name': 'El Gran Combo'}, {'id': 9676, 'name': 'El Gran Combo de Puerto Rico'}, {'id': 8613614, 'name': 'Eladio Carrion'}, {'id': 243546, 'name': 'Eloy'}, {'id': 302, 'name': 'Elvis Crespo'}, {'id': 14739637, 'name': 'ELYSANIJ'}, {'id': 61094422, 'name': 'Emilia'}, {'id': 13, 'name': 'Eminem'}, {'id': 2792, 'name': 'Enrique Iglesias'}, {'id': 4432412, 'name': 'Eric Bellinger'}, {'id': 271531, 'name': 'Erre Xi'}, {'id': 14007429, 'name': 'Esme'}, {'id': 4018749, 'name': 'Eunel Nueva Era'}, {'id': 9364778, 'name': 'F4 y Eminencia'}, {'id': 5821103, 'name': 'Farina'}, {'id': 614223, 'name': 'Farruko'}, {'id': 1040448, 'name': 'Fat Trel'}, {'id': 1166311, 'name': 'Feid'}, {'id': 14346831, 'name': 'Ferrer El Tanque'}, {'id': 7200950, 'name': 'Fetty Wap'}, {'id': 243758, 'name': 'Flex'}, {'id': 68719442, 'name': 'Flow La Movie'}, {'id': 52690762, 'name': 'FNF Chop'}, {'id': 193164, 'name': 'Franco "El Gorilla"'}, {'id': 1427943, 'name': 'Franco El Gorila'}, {'id': 8797, 'name': 'Frank Reyes'}, {'id': 16240, 'name': 'Frankie Ruiz'}, {'id': 367387, 'name': 'French Montana'}, {'id': 10460749, 'name': 'Fresh Kid Cue'}, {'id': 165930, 'name': 'Future'}, {'id': 9000780, 'name': 'Gaby Morales'}, {'id': 1176586, 'name': 'Galante "El Emperador"'}, {'id': 1202208, 'name': 'Genio'}, {'id': 279489, 'name': 'Gente De Zona'}, {'id': 2314, 'name': 'Gilberto Santa Rosa'}, {'id': 10150574, 'name': 'Gino Mella'}, {'id': 4893530, 'name': 'Gotay "El Autentiko"'}, {'id': 12944237, 'name': 'Greeicy'}, {'id': 519566, 'name': 'Grupo Extra'}, {'id': 16107, 'name': 'Grupo Niche'}, {'id': 458239, 'name': 'Guayacan Orquesta'}, {'id': 49197782, 'name': 'Guaynaa'}, {'id': 7972, 'name': 'Gucci Mane'}, {'id': 13107235, 'name': 'guccihighwaters'}, {'id': 361257, 'name': 'Guelo Star'}, {'id': 94911872, 'name': 'Haga Su Diligencia'}, {'id': 988368, 'name': 'Hancel'}, {'id': 107939232, 'name': 'Hansen Akilez'}, {'id': 1530947, 'name': 'Hector Acosta "El Torito"'}, {'id': 63948992, 'name': 'Hotboii'}, {'id': 63282952, 'name': 'Hozwal'}, {'id': 4277041, 'name': 'Héctor "El Father"'}, {'id': 94024, 'name': 'Héctor Lavoe'}, {'id': 55868, 'name': 'Ismael Rivera'}, {'id': 9019, 'name': 'Ivy Queen'}, {'id': 5550504, 'name': 'Izaak'}, {'id': 1401504, 'name': 'J Alvarez'}, {'id': 4860761, 'name': 'J Balvin'}, {'id': 15225249, 'name': 'J Gonz'}, {'id': 4961594, 'name': 'J-King y Maximan'}, {'id': 339209, 'name': 'J. Cole'}, {'id': 9093938, 'name': 'Jack Harlow'}, {'id': 9643804, 'name': 'Jadi Torres'}, {'id': 113003282, 'name': 'Jadiel'}, {'id': 6580381, 'name': 'Jadiel el Incomparable'}, {'id': 4661415, 'name': 'Jahzel'}, {'id': 9472712, 'name': 'Jamby El Favo'}, {'id': 14729989, 'name': 'Javiielo'}, {'id': 89740, 'name': 'Jay Ramirez'}, {'id': 1074021, 'name': 'Jay Wheeler'}, {'id': 1309, 'name': 'Jay-Z'}, {'id': 1477173, 'name': 'Jazz Cartier'}, {'id': 12756025, 'name': 'Jd Pantoja'}, {'id': 1338623, 'name': 'Jeezy'}, {'id': 5372025, 'name': 'Jehu El Rey'}, {'id': 7969, 'name': 'Jerry Rivera'}, {'id': 51997282, 'name': 'JFab & Paola Fabre'}, {'id': 13098657, 'name': 'Jhay Cortez'}, {'id': 288, 'name': 'Jim Jones'}, {'id': 49244632, 'name': 'Jodosky'}, {'id': 331851, 'name': 'Joe Arroyo'}, {'id': 260106, 'name': 'Joe Veras'}, {'id': 355885, 'name': 'Johnny Rivera'}, {'id': 9334770, 'name': 'Jon Z'}, {'id': 12496716, 'name': 'Jonna Torres'}, {'id': 3764901, 'name': 'Jorge Ruiz'}, {'id': 4808771, 'name': 'Jory Boy'}, {'id': 260096, 'name': 'Jose Peña Suazo Y La Banda Gorda'}, {'id': 71835, 'name': 'José José'}, {'id': 12239866, 'name': 'Jounel'}, {'id': 265175, 'name': 'Jowell & Randy'}, {'id': 71813, 'name': 'Juan Gabriel'}, {'id': 4527779, 'name': 'Juan Luis Guerra'}, {'id': 450723, 'name': 'Juan Luis Guerra 440'}, {'id': 70, 'name': 'Juanes'}, {'id': 8658114, 'name': 'Juanka'}, {'id': 10388560, 'name': 'Juhn'}, {'id': 14456487, 'name': 'Juice Wrld'}, {'id': 12294, 'name': 'Juicy J'}, {'id': 1348484, 'name': 'Juno "The Hitmaker"'}, {'id': 5849210, 'name': 'Justin Quiles'}, {'id': 10965686, 'name': 'JVO the Writer'}, {'id': 102384712, 'name': 'K-Drian'}, {'id': 230, 'name': 'Kanye West'}, {'id': 4059855, 'name': 'Karlos Rosé'}, {'id': 5297021, 'name': 'KAROL G'}, {'id': 4393285, 'name': 'Kelmitt'}, {'id': 2047451, 'name': 'Kendo Kaponi'}, {'id': 525046, 'name': 'Kendrick Lamar'}, {'id': 2005121, 'name': 'Kevin Gates'}, {'id': 1592801, 'name': 'Kevin Roldan'}, {'id': 61498882, 'name': 'KEVVO'}, {'id': 4027523, 'name': 'Kewin Cosmos'}, {'id': 12477784, 'name': 'Keytel'}, {'id': 13028375, 'name': 'KHEA'}, {'id': 158706, 'name': 'Kid Cudi'}, {'id': 1154611, 'name': 'Kid Ink'}, {'id': 8285592, 'name': 'Kiko El Crazy'}, {'id': 5201395, 'name': 'Killatonez'}, {'id': 12431462, 'name': 'King Von'}, {'id': 7260670, 'name': 'Kodak Black'}, {'id': 1260361, 'name': 'La Banda Gorda'}, {'id': 826409, 'name': 'La Gloria Matancera'}, {'id': 10628057, 'name': 'Lafame'}, {'id': 5526627, 'name': 'Lalo Ebratt'}, {'id': 10149178, 'name': 'Lary Over'}, {'id': 49061611, 'name': 'LeBray'}, {'id': 14718485, 'name': 'Lele Pons'}, {'id': 7208392, 'name': 'Lenny Tavarez'}, {'id': 398521, 'name': 'Lil Baby'}, {'id': 3977201, 'name': 'Lil Durk'}, {'id': 75317012, 'name': 'Lil Eazzyy'}, {'id': 14274653, 'name': 'Lil Gnar'}, {'id': 14492701, 'name': 'Lil Tecca'}, {'id': 51464362, 'name': 'Lil Tjay'}, {'id': 7101343, 'name': 'Lil Uzi Vert'}, {'id': 74309, 'name': 'Lil Wayne'}, {'id': 9776678, 'name': 'Lil Yachty'}, {'id': 5211301, 'name': 'Limi-t XXI'}, {'id': 5813339, 'name': 'Linares'}, {'id': 92, 'name': 'Linkin Park'}, {'id': 9581234, 'name': 'Linowz'}, {'id': 3051051, 'name': 'Lirow'}, {'id': 60992842, 'name': 'Llane'}, {'id': 72660, 'name': 'Logic'}, {'id': 5201736, 'name': 'Los Cantantes'}, {'id': 6459251, 'name': 'Los De La Nazza'}, {'id': 367462, 'name': 'Los Hermanos Rosario'}, {'id': 6611456, 'name': 'Los Legendarios'}, {'id': 260090, 'name': 'Los Toros Band'}, {'id': 5692835, 'name': 'Luigi 21 Plus'}, {'id': 6707, 'name': 'Luis Fonsi'}, {'id': 6123, 'name': 'Luis Miguel'}, {'id': 2410181, 'name': 'Luis Vazquez'}, {'id': 7091251, 'name': 'Lula Miranda'}, {'id': 7029627, 'name': 'Lunay'}, {'id': 1568566, 'name': 'Luny Tunes'}, {'id': 11025346, 'name': 'Lyanno'}, {'id': 632926, 'name': 'MAC MILLER'}, {'id': 4419187, 'name': 'Mackie'}, {'id': 9928732, 'name': 'MadeinTYO'}, {'id': 56840122, 'name': 'MadMarcc'}, {'id': 13511, 'name': 'Maelo Ruiz'}, {'id': 186633, 'name': 'Magnate Y Valentino'}, {'id': 1424602, 'name': 'Maluma'}, {'id': 4425846, 'name': 'Mambo Kingz'}, {'id': 11141184, 'name': 'Manny Rod'}, {'id': 11559031, 'name': 'Manuel Turizo'}, {'id': 4115, 'name': 'Maná'}, {'id': 112, 'name': 'Marc Anthony'}, {'id': 5546921, 'name': 'Marco Puma'}, {'id': 100314362, 'name': 'Mariah Angeliq'}, {'id': 10189722, 'name': 'Mau y Ricky'}, {'id': 280696, 'name': 'Mc ceja'}, {'id': 413596, 'name': 'Meek Mill'}, {'id': 5904428, 'name': 'Mega Sexxx'}, {'id': 12124680, 'name': 'Mega XxX'}, {'id': 94311, 'name': 'Merengue Latin Band'}, {'id': 101820, 'name': 'Messiah'}, {'id': 4968870, 'name': 'Metro Boomin'}, {'id': 4962010, 'name': 'Migos'}, {'id': 5524597, 'name': 'Mike Bahia'}, {'id': 5147523, 'name': 'Mike Will Made-It'}, {'id': 10177296, 'name': 'Miky Woodz'}, {'id': 16235, 'name': 'Monchy & Alexandra'}, {'id': 7889792, 'name': 'Moneybagg Yo'}, {'id': 1710880, 'name': 'Montano'}, {'id': 350042, 'name': 'Mozart la Para'}, {'id': 4331312, 'name': 'Mr. Don'}, {'id': 4405246, 'name': 'Mr. Frank & Gabyson'}, {'id': 4811119, 'name': 'Musicologo Y Menes'}, {'id': 12029862, 'name': 'Myke Towers'}, {'id': 14323, 'name': "N'Klabe"}, {'id': 73, 'name': 'Nas'}, {'id': 2829671, 'name': 'Natti Natasha'}, {'id': 1180218, 'name': 'NAV'}, {'id': 9480512, 'name': 'Neutro Shorty'}, {'id': 5877609, 'name': 'Nfasis'}, {'id': 15691, 'name': 'Nicky Jam'}, {'id': 9383750, 'name': 'Nicole Zignago'}, {'id': 241472, 'name': 'Nigga'}, {'id': 8945638, 'name': 'Nio Garcia'}, {'id': 57203182, 'name': 'NLE Choppa'}, {'id': 85274642, 'name': 'Noriega'}, {'id': 8310400, 'name': 'Noriel'}, {'id': 1265358, 'name': 'Nova y Jory'}, {'id': 5510618, 'name': 'O.T. Genasis'}, {'id': 68334, 'name': 'Offset'}, {'id': 6125, 'name': 'Olga Tañón'}, {'id': 433256, 'name': 'Oro Solido'}, {'id': 12544, 'name': "Oscar D'León"}, {'id': 272654, 'name': 'Ovi'}, {'id': 4937383, 'name': 'Ozuna'}, {'id': 9866032, 'name': 'Pacho El Antifeka'}, {'id': 483395, 'name': 'Paquito Guzmán'}, {'id': 1686757, 'name': 'Paradize'}, {'id': 4925172, 'name': 'PARTYNEXTDOOR'}, {'id': 1464, 'name': 'Paulina Rubio'}, {'id': 10485251, 'name': 'Pinto Picasso'}, {'id': 4038501, 'name': 'Piso 21'}, {'id': 10002824, 'name': 'Playboi Carti'}, {'id': 15370, 'name': 'Plies'}, {'id': 8274374, 'name': 'PnB Rock'}, {'id': 49818632, 'name': 'POLO G'}, {'id': 61799192, 'name': 'Pooh Shiesty'}, {'id': 58447102, 'name': 'Pop Smoke'}, {'id': 7543848, 'name': 'Post Malone'}, {'id': 380955, 'name': 'Prince Royce'}, {'id': 12161, 'name': 'Project Pat'}, {'id': 6512133, 'name': 'Pusho'}, {'id': 498918, 'name': 'Quality Control'}, {'id': 14029747, 'name': 'Quando Rondo'}, {'id': 5059044, 'name': 'Quavo'}, {'id': 5575762, 'name': 'Rae Sremmurd'}, {'id': 6004048, 'name': 'Rafa Pabön'}, {'id': 7551010, 'name': 'Ralphy Dreamz'}, {'id': 607194, 'name': 'Ramon Orlando'}, {'id': 61525222, 'name': 'Randy'}, {'id': 5312978, 'name': 'Raphy Leavitt & Orquesta La Selecta'}, {'id': 260100, 'name': 'Raulín Rodríguez'}, {'id': 11289472, 'name': 'Rauw Alejandro'}, {'id': 12497300, 'name': 'Rayda la Sensacion'}, {'id': 4476, 'name': 'Reik'}, {'id': 7615, 'name': 'Rey Ruiz'}, {'id': 4204510, 'name': 'Reykon'}, {'id': 4312845, 'name': 'Rich Homie Quan'}, {'id': 11471022, 'name': 'RICH MUSIC LTD'}, {'id': 4989034, 'name': 'Rich The Kid'}, {'id': 9112, 'name': 'Rick Ross'}, {'id': 8842486, 'name': 'Rikar2nes'}, {'id': 260087, 'name': 'Rikarena'}, {'id': 12919475, 'name': 'Rod Wave'}, {'id': 13594287, 'name': 'Roddy Ricch'}, {'id': 10219670, 'name': 'Rodrigo Films'}, {'id': 1272674, 'name': 'Romeo Santos'}, {'id': 5550327, 'name': 'Ronald El Killa'}, {'id': 554792, 'name': 'Rosalía'}, {'id': 8599360, 'name': 'Roy Woods'}, {'id': 15796, 'name': 'Rubén Blades'}, {'id': 89254692, 'name': 'Ruuz'}, {'id': 4660899, 'name': 'Rvssian'}, {'id': 11815065, 'name': 'Ryan Castro'}, {'id': 62532932, 'name': 'Sael'}, {'id': 9299470, 'name': 'Sammy & Falsetto'}, {'id': 1057597, 'name': 'Schoolboy Q'}, {'id': 9204370, 'name': 'Sebastian LVDA'}, {'id': 5266156, 'name': 'Sebastian Yatra'}, {'id': 5412407, 'name': 'Sech'}, {'id': 448830, 'name': 'Sergio Vargas'}, {'id': 4312707, 'name': 'Shy Glizzy'}, {'id': 525343, 'name': 'Silvestre Dangond'}, {'id': 5523075, 'name': 'Sixto Rein'}, {'id': 11347866, 'name': 'Ski Mask the Slump God'}, {'id': 240427, 'name': 'Sky'}, {'id': 11133, 'name': 'Slim Thug'}, {'id': 1034717, 'name': 'SOG'}, {'id': 8112045, 'name': 'SP Polanco'}, {'id': 4038431, 'name': 'Speaker Knockerz'}, {'id': 89983272, 'name': 'Stampede Artist'}, {'id': 4861679, 'name': 'Super Yei'}, {'id': 7627172, 'name': 'Swae Lee'}, {'id': 4649104, 'name': 'Tainy'}, {'id': 1622596, 'name': 'Takeoff'}, {'id': 11393622, 'name': 'Tee Grizzley'}, {'id': 6729, 'name': 'Tego Calderón'}, {'id': 86151732, 'name': 'Tempo'}, {'id': 52888672, 'name': 'Tenso Beats'}, {'id': 257541, 'name': 'Teodoro Reyes'}, {'id': 3506, 'name': 'The Diplomats'}, {'id': 2519, 'name': 'The Notorious B.I.G.'}, {'id': 4050205, 'name': 'The Weeknd'}, {'id': 49364062, 'name': 'Tiago pzk'}, {'id': 215091, 'name': 'Tito El Bambino'}, {'id': 6717, 'name': 'Tito Nieves'}, {'id': 190482, 'name': 'Tito Rojas'}, {'id': 320149, 'name': 'Toby Love'}, {'id': 112230, 'name': 'Tommy Olivencia'}, {'id': 193162, 'name': 'Tony Dize'}, {'id': 3972971, 'name': 'Tony Lenta'}, {'id': 255688, 'name': 'Tony Vega'}, {'id': 5575105, 'name': 'Tory Lanez'}, {'id': 9977062, 'name': 'Totoy El Frio'}, {'id': 67488, 'name': 'Toño Rosario'}, {'id': 391945, 'name': 'Travis Porter'}, {'id': 4495513, 'name': 'Travis Scott'}, {'id': 8472, 'name': 'Trebol Clan'}, {'id': 9096522, 'name': 'Trevor Daniel'}, {'id': 11934257, 'name': 'Trippie Redd'}, {'id': 4438587, 'name': 'Ty Dolla $ign'}, {'id': 11143816, 'name': 'Tyla Yaweh'}, {'id': 1194083, 'name': 'Tyler, The Creator'}, {'id': 58847692, 'name': 'vf7'}, {'id': 8798, 'name': 'Vicente Fernández'}, {'id': 8650, 'name': 'Victor Manuelle'}, {'id': 10761, 'name': 'Voltio'}, {'id': 1385870, 'name': 'Voz A Voz'}, {'id': 413051, 'name': 'Waka Flocka Flame'}, {'id': 281561, 'name': 'Wale'}, {'id': 290566, 'name': 'Wibal y Alex'}, {'id': 331848, 'name': 'Wilfrido Vargas'}, {'id': 5611, 'name': 'Willie Colón'}, {'id': 102704, 'name': 'Willie Gonzalez'}, {'id': 5057402, 'name': 'Wise "the Gold Pen"'}, {'id': 15898, 'name': 'Wisin'}, {'id': 75156, 'name': 'Wisin & Yandel'}, {'id': 74804, 'name': 'Wiz Khalifa'}, {'id': 1518489, 'name': 'WWE'}, {'id': 399680, 'name': 'Xtreme'}, {'id': 9822974, 'name': 'XXXTentacion'}, {'id': 345026, 'name': 'Yaga & Mackie'}, {'id': 517429, 'name': 'Yandel'}, {'id': 629036, 'name': 'Yelsid'}, {'id': 14118027, 'name': 'Yextiel'}, {'id': 13327309, 'name': 'YNW Melly'}, {'id': 103369, 'name': 'Yo Gotti'}, {'id': 186191, 'name': 'Yomo'}, {'id': 1378319, 'name': 'Young Chop'}, {'id': 11554747, 'name': 'Young Cister'}, {'id': 4099751, 'name': 'Young Dolph'}, {'id': 13283955, 'name': 'Young Eiby'}, {'id': 117111442, 'name': 'Young Stoner Life'}, {'id': 1590752, 'name': 'Young Thug'}, {'id': 11279454, 'name': 'YoungBoy Never Broke Again'}, {'id': 11203568, 'name': 'Yung Gravy'}, {'id': 260107, 'name': 'Zacarías Ferreira'}, {'id': 1247771, 'name': 'ZAYTOVEN'}, {'id': 17046, 'name': 'Zion'}, {'id': 1217914, 'name': 'Zion & Lennox'}, {'id': 894266, 'name': 'Ñejo'}, {'id': 326042, 'name': 'Ñengo Flow'}, {'id': 4062938, 'name': 'Öken'}]

    monitor = Monitor()
    monitor.artists(list_of_artist_names)
    # monitor.build_query(mock_api)